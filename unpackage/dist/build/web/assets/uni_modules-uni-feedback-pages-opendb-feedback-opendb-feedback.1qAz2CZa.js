import{Z as e,s as t,h as a,a as o,y as l,z as r,r as n,c as s,w as i,l as m,o as u,b as f,d,_ as c,B as p}from"./index-nnZW9WDd.js";import{_ as b}from"./uni-forms-item.CBR7qWz9.js";import{r as h}from"./uni-app.es.YMhB4L0_.js";import{_ as g}from"./uni-file-picker.xRZRjom7.js";import{_}from"./uni-easyinput.o8bItaYz.js";import{_ as y}from"./uni-forms.Ds0BSXHg.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.BTZacCfd.js";const D={content:{rules:[{required:!0},{format:"string"}],label:"留言内容/回复内容"},imgs:{rules:[{format:"array"},{arrayType:"file"},{maxLength:6}],label:"图片列表"},contact:{rules:[{format:"string"}],label:"联系人"},mobile:{rules:[{format:"string"},{pattern:"^\\+?[0-9-]{3,20}$"}],label:"联系电话"}};console.log(D);const j=e.database();function v(e){let t={};for(let a in D)e.indexOf(a)>-1&&(t[a]=D[a]);return t}const k=V({data(){let e={content:"",imgs:[],contact:"",mobile:""};return{formData:e,formOptions:{},rules:{...v(Object.keys(e))}}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){t({mask:!0}),this.$refs.form.validate().then((e=>{this.submitForm(e)})).catch((()=>{a()}))},submitForm(e){j.collection("opendb-feedback").add(e).then((e=>{o({icon:"none",title:"提交成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>l()),500)})).catch((e=>{r({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{a()}))}}},[["render",function(e,t,a,o,l,r){const V=c,D=h(n("uni-forms-item"),b),j=h(n("uni-file-picker"),g),v=h(n("uni-easyinput"),_),k=p,x=m,C=h(n("uni-forms"),y);return u(),s(x,{class:"uni-container"},{default:i((()=>[f(C,{ref:"form",value:l.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:i((()=>[f(D,{name:"content",label:"留言内容/回复内容",required:""},{default:i((()=>[f(V,{onInput:t[0]||(t[0]=t=>e.binddata("content",t.detail.value)),class:"uni-textarea-border",modelValue:l.formData.content,"onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.content=e),trim:"right"},null,8,["modelValue"])])),_:1}),f(D,{name:"imgs",label:"图片列表"},{default:i((()=>[f(j,{"file-mediatype":"image",limit:6,"return-type":"array",modelValue:l.formData.imgs,"onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.imgs=e)},null,8,["modelValue"])])),_:1}),f(D,{name:"contact",label:"联系人"},{default:i((()=>[f(v,{modelValue:l.formData.contact,"onUpdate:modelValue":t[3]||(t[3]=e=>l.formData.contact=e),trim:"both"},null,8,["modelValue"])])),_:1}),f(D,{name:"mobile",label:"联系电话"},{default:i((()=>[f(v,{modelValue:l.formData.mobile,"onUpdate:modelValue":t[4]||(t[4]=e=>l.formData.mobile=e),trim:"both"},null,8,["modelValue"])])),_:1}),f(x,{class:"uni-button-group"},{default:i((()=>[f(k,{type:"primary",class:"uni-button",onClick:r.submit},{default:i((()=>[d("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-50b92ee8"]]);export{k as default};
